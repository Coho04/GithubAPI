package de.coho04.githubapi.entities;

import de.coho04.githubapi.bases.GHBase;
import org.json.JSONObject;

@SuppressWarnings("unused")
public class GHVulnerability extends GHBase {

    public GHPackage ghPackage;
    public String firstPatchedVersion;
    public String vulnerableVersionRange;
    public String[] vulnerableFunctions;

    public GHVulnerability(JSONObject jsonObject) {
        this.ghPackage = new GHPackage(jsonObject.getJSONObject("package"));
        this.firstPatchedVersion = getStringOrNull(jsonObject, "first_patched_version");
        this.vulnerableVersionRange = getStringOrNull(jsonObject, "vulnerable_version_range");
        this.vulnerableFunctions = getArrayOrNull(jsonObject, "vulnerable_functions", JSONObject::toString).toArray(new String[0]);
    }

    public GHPackage getGhPackage() {
        return ghPackage;
    }

    public String getFirstPatchedVersion() {
        return firstPatchedVersion;
    }

    public String getVulnerableVersionRange() {
        return vulnerableVersionRange;
    }

    public String[] getVulnerableFunctions() {
        return vulnerableFunctions;
    }
}
